{
  "version": 3,
  "sources": ["../src/lib/create-state.ts"],
  "sourcesContent": ["import type { StateCreator } from 'zustand'\r\nimport create from 'zustand'\r\nimport { ActionProto, AsyncReducer, AsyncDispatch } from '..'\r\nimport { DeepReadonly } from './deep-readonly.types'\r\n\r\n/**\r\n * This function largely follows the zustand redux middleware format\r\n * https://github.com/pmndrs/zustand/blob/main/src/middleware/redux.ts\r\n */\r\nexport function asyncRedux<S extends object, A extends ActionProto>(\r\n  reducer: AsyncReducer<S, A>,\r\n  initial: S\r\n) {\r\n  type State = {\r\n    dispatch: AsyncDispatch<A>\r\n  } & S\r\n\r\n  const adapter: StateCreator<State> = (set, get) => {\r\n    async function dispatch(action: A) {\r\n      set(await reducer(action, get as () => DeepReadonly<S>, dispatch))\r\n    }\r\n\r\n    return { dispatch, ...initial }\r\n  }\r\n\r\n  return adapter\r\n}\r\n\r\nexport function createAsyncState<S extends object, A extends ActionProto>(\r\n  reducer: AsyncReducer<S, A>,\r\n  initial: S\r\n) {\r\n  const stateHook = create(asyncRedux(reducer, initial))\r\n  return [stateHook.getState().dispatch, stateHook] as const\r\n}\r\n"],
  "mappings": "siBACA,OAAOA,MAAY,UAQZ,SAASC,EACdC,EACAC,EACA,CAaA,MARqC,CAACC,EAAKC,IAAQ,CACjD,SAAeC,EAASC,EAAW,QAAAC,EAAA,sBACjCJ,EAAI,MAAMF,EAAQK,EAAQF,EAA8BC,CAAQ,CAAC,CACnE,GAEA,OAAOG,EAAA,CAAE,SAAAH,GAAaH,EACxB,CAGF,CAEO,SAASO,EACdR,EACAC,EACA,CACA,IAAMQ,EAAYC,EAAOX,EAAWC,EAASC,CAAO,CAAC,EACrD,MAAO,CAACQ,EAAU,SAAS,EAAE,SAAUA,CAAS,CAClD",
  "names": ["create", "asyncRedux", "reducer", "initial", "set", "get", "dispatch", "action", "__async", "__spreadValues", "createAsyncState", "stateHook", "create"]
}
